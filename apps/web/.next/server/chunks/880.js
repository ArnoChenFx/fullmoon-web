exports.id=880,exports.ids=[880],exports.modules={6589:(e,t,s)=>{Promise.resolve().then(s.bind(s,63)),Promise.resolve().then(s.bind(s,7620))},557:(e,t,s)=>{Promise.resolve().then(s.bind(s,8475)),Promise.resolve().then(s.bind(s,6368))},6542:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,4217,23)),Promise.resolve().then(s.t.bind(s,1409,23)),Promise.resolve().then(s.t.bind(s,313,23)),Promise.resolve().then(s.t.bind(s,2392,23)),Promise.resolve().then(s.t.bind(s,2683,23)),Promise.resolve().then(s.t.bind(s,1196,23)),Promise.resolve().then(s.t.bind(s,8243,23))},9238:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,8165,23)),Promise.resolve().then(s.t.bind(s,2581,23)),Promise.resolve().then(s.t.bind(s,3725,23)),Promise.resolve().then(s.t.bind(s,3796,23)),Promise.resolve().then(s.t.bind(s,5055,23)),Promise.resolve().then(s.t.bind(s,4976,23)),Promise.resolve().then(s.t.bind(s,3487,23))},9289:(e,t,s)=>{"use strict";s.d(t,{ChatInterface:()=>D});var a=s(7034),r=s(3587),n=s(6063),i=s(3272),o=s(5584),l=s(7423),d=s(99),c=s(170),u=s(214),m=s(7349);function h(...e){return(0,m.QP)((0,u.$)(e))}let x=r.forwardRef(({className:e,...t},s)=>(0,a.jsx)("textarea",{className:h("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...t}));x.displayName="Textarea";var f=s(3135);let v=(0,s(1134).F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),g=r.forwardRef(({className:e,variant:t,size:s,asChild:r=!1,...n},i)=>{let o=r?f.DX:"button";return(0,a.jsx)(o,{className:h(v({variant:t,size:s,className:e})),ref:i,...n})});g.displayName="Button";var p=s(4396),b=s(1506),w=s(6368);let y={NEW:"new",WAXING_CRESCENT:"waxing-crescent",FIRST_QUARTER:"first-quarter",WAXING_GIBBOUS:"waxing-gibbous",FULL:"full",WANING_GIBBOUS:"waning-gibbous",LAST_QUARTER:"last-quarter",WANING_CRESCENT:"waning-crescent"};function N({phase:e,size:t=24,color:s="currentColor"}){return(0,a.jsx)("svg",{width:t,height:t,viewBox:`0 0 ${t} ${t}`,fill:"none",xmlns:"http://www.w3.org/2000/svg",role:"img","aria-label":`Moon phase: ${e}`,children:(()=>{switch(e){case y.NEW:return(0,a.jsx)("circle",{cx:t/2,cy:t/2,r:t/2-1,fill:"none",stroke:s});case y.WAXING_CRESCENT:return(0,a.jsx)("path",{d:`M${t/2},1 A${t/2-1},${t/2-1} 0 1,1 ${t/2},${t-1} A${t/4},${t/2-1} 0 1,0 ${t/2},1`,fill:s});case y.FIRST_QUARTER:return(0,a.jsx)("path",{d:`M${t/2},1 A${t/2-1},${t/2-1} 0 1,1 ${t/2},${t-1} L${t/2},1`,fill:s});case y.WAXING_GIBBOUS:return(0,a.jsx)("path",{d:`M${t/2},1 A${t/2-1},${t/2-1} 0 1,1 ${t/2},${t-1} A${t/4},${t/2-1} 0 0,1 ${t/2},1`,fill:s});case y.FULL:return(0,a.jsx)("circle",{cx:t/2,cy:t/2,r:t/2-1,fill:s,stroke:"none"});case y.WANING_GIBBOUS:return(0,a.jsx)("path",{d:`M${t/2},1 A${t/2-1},${t/2-1} 0 1,0 ${t/2},${t-1} A${t/4},${t/2-1} 0 0,0 ${t/2},1`,fill:s});case y.LAST_QUARTER:return(0,a.jsx)("path",{d:`M${t/2},1 A${t/2-1},${t/2-1} 0 1,0 ${t/2},${t-1} L${t/2},1`,fill:s});case y.WANING_CRESCENT:return(0,a.jsx)("path",{d:`M${t/2},1 A${t/2-1},${t/2-1} 0 1,0 ${t/2},${t-1} A${t/4},${t/2-1} 0 1,1 ${t/2},1`,fill:s});default:return null}})()})}var j=s(8139),C=s(9591);let A=j.bL;j.l9;let $=j.ZL;j.bm;let S=r.forwardRef(({className:e,...t},s)=>(0,a.jsx)(j.hJ,{ref:s,className:h("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));S.displayName=j.hJ.displayName;let P=r.forwardRef(({className:e,children:t,...s},r)=>(0,a.jsxs)($,{children:[(0,a.jsx)(S,{}),(0,a.jsxs)(j.UC,{ref:r,className:h("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s,children:[t,(0,a.jsxs)(j.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(C.MKb,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));P.displayName=j.UC.displayName;let I=({className:e,...t})=>(0,a.jsx)("div",{className:h("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});I.displayName="DialogHeader";let k=r.forwardRef(({className:e,...t},s)=>(0,a.jsx)(j.hE,{ref:s,className:h("text-lg font-semibold leading-none tracking-tight",e),...t}));k.displayName=j.hE.displayName;let R=r.forwardRef(({className:e,...t},s)=>(0,a.jsx)(j.VY,{ref:s,className:h("text-sm text-muted-foreground",e),...t}));R.displayName=j.VY.displayName;var E=s(7269),T=s(8762),M=s(1200);function _(){let{setTheme:e,theme:t}=(0,M.D)();return(0,a.jsxs)(g,{variant:"ghost",size:"icon",onClick:()=>e("light"===t?"dark":"light"),children:[(0,a.jsx)(E.A,{className:"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),(0,a.jsx)(T.A,{className:"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),(0,a.jsx)("span",{className:"sr-only",children:"Toggle theme"})]})}function U({open:e,onOpenChange:t}){return(0,a.jsx)(A,{open:e,onOpenChange:t,children:(0,a.jsxs)(P,{children:[(0,a.jsxs)(I,{children:[(0,a.jsx)(k,{children:"Settings"}),(0,a.jsx)(R,{children:"Customize your chat experience."})]}),(0,a.jsx)("div",{className:"grid gap-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsx)("label",{htmlFor:"theme-toggle",className:"text-sm font-medium leading-none",children:"Theme"}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Switch between light and dark mode."})]}),(0,a.jsx)(_,{})]})})]})})}let G=new(s(1633)).X;function D({convo:e}){let[t,s]=(0,r.useState)(!1),{isSidebarOpen:u,toggleSidebar:m}=(0,w.c)(),h=(0,p.useRouter)(),[f,v]=(0,r.useState)(e?.id||null),[,j]=(0,r.useState)(e||null),C=(0,r.useRef)(null),{messages:A,input:$,handleInputChange:S,handleSubmit:P,isLoading:I}=(0,n.Y_)({initialMessages:e?.messages||[],body:{conversationId:f},id:f||"new",onFinish:async e=>{if(f)try{await G.createMessage({content:e.content,role:"assistant",conversationId:f,createdAt:new Date})}catch(e){console.error("Failed to save assistant message:",e)}}});(0,r.useCallback)(()=>{C.current?.scrollIntoView({behavior:"smooth"})},[]);let k=async e=>{if(e.preventDefault(),!$.trim()||I)return;let t=$.trim();if(f)try{await G.createMessage({content:t,role:"user",conversationId:f,createdAt:new Date})}catch(e){console.error("Failed to save user message:",e)}else try{let e=await G.createConversation({title:t.slice(0,80),createdAt:new Date,updatedAt:new Date});await G.createMessage({content:t,role:"user",conversationId:e.id,createdAt:new Date}),v(e.id),h.replace(`/c/${e.id}`);return}catch(e){console.error("Failed to create conversation:",e)}P(e)};return(0,a.jsxs)("div",{className:`flex-1 flex justify-center transition-all duration-200 ease-in-out ${u?"pl-64":"pl-0"}`,children:[(0,a.jsx)("div",{className:"fixed top-0 left-0 right-0 p-4 bg-background border-b text-center",children:(0,a.jsxs)("div",{className:`flex items-center justify-between h-6 transition-all duration-200 ease-in-out ${u?"ml-64":"ml-20"}`,children:[(0,a.jsx)("h1",{className:"text-md font-bold",children:e?.title||"chat"}),(0,a.jsx)(g,{variant:"ghost",size:"icon",className:"text-gray-400 hover:text-gray-300",onClick:()=>s(!0),children:(0,a.jsx)(i.A,{className:"h-3 w-3"})})]})}),(0,a.jsxs)("div",{className:"fixed top-4 left-4 z-40 flex gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:m,className:"p-2 rounded-full bg-secondary hover:bg-secondary/80",children:(0,a.jsx)(o.A,{className:"h-3 w-3"})}),(0,a.jsx)(b.default,{href:"/",className:"p-2 hover:rounded-full hover:bg-secondary/80",children:(0,a.jsx)(l.A,{className:"h-3 w-3"})})]}),(0,a.jsxs)("main",{className:"w-full max-w-2xl p-4 mt-16 mb-16",children:[0===A.length?(0,a.jsx)("div",{className:"flex flex-col items-center justify-center h-[calc(100vh-200px)]",children:(0,a.jsx)(N,{phase:(()=>{switch(function(){let e=new Date,t=e.getFullYear(),s=e.getMonth()+1,a=((367*t-Math.floor(7*(t+Math.floor((s+9)/12))/4)+Math.floor(275*s/9)+e.getDate()-730530)%29.53+29.53)%29.53;return a<1.84566?"new":a<5.53699?"waxing-crescent":a<9.22831?"first-quarter":a<12.91963?"waxing-gibbous":a<16.61096?"full":a<20.30228?"waning-gibbous":a<23.99361?"last-quarter":a<27.68493?"waning-crescent":"new"}()){case"new":default:return y.NEW;case"waxing-crescent":return y.WAXING_CRESCENT;case"first-quarter":return y.FIRST_QUARTER;case"waxing-gibbous":return y.WAXING_GIBBOUS;case"full":return y.FULL;case"waning-gibbous":return y.WANING_GIBBOUS;case"last-quarter":return y.LAST_QUARTER;case"waning-crescent":return y.WANING_CRESCENT}})(),size:48,color:"currentColor"})}):(0,a.jsx)("div",{className:"space-y-4",children:A.map((e,t)=>(0,a.jsx)("div",{className:`flex ${"user"===e.role?"justify-end":"justify-start"}`,children:(0,a.jsx)("div",{className:`max-w-[80%] rounded-3xl px-4 py-2 ${"user"===e.role?"bg-secondary text-foreground":"text-foreground"}`,children:(0,a.jsxs)("p",{className:"whitespace-pre-wrap",children:[e.content,I&&t===A.length-1&&"assistant"===e.role&&"\uD83C\uDF15"]})})},e.id))}),(0,a.jsx)("div",{ref:C})]}),(0,a.jsx)("div",{className:"fixed bottom-0 w-full bg-background",children:(0,a.jsx)("form",{onSubmit:k,className:"relative",children:(0,a.jsx)("div",{className:"max-w-2xl mx-auto w-full",children:(0,a.jsxs)("div",{className:"flex flex-col m-4 px-2 py-1 bg-secondary rounded-3xl",children:[(0,a.jsx)(x,{value:$,onChange:S,placeholder:"ask me anything...",rows:1,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),k(e))},className:"w-full border-none text-foreground placeholder:text-gray-400 resize-none focus-visible:ring-0 focus-visible:ring-offset-0 min-h-[36px] align-middle shadow-none"}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center gap-0",children:(0,a.jsx)(g,{type:"button",variant:"ghost",size:"icon",className:"text-gray-400 hover:text-gray-300",children:(0,a.jsx)(d.A,{className:"h-5 w-5"})})}),(0,a.jsx)(g,{type:"submit",variant:"ghost",size:"icon",className:"text-gray-400 hover:text-gray-300",disabled:I||!$.trim(),children:(0,a.jsx)(c.A,{className:"h-5 w-5"})})]})]})})})}),(0,a.jsx)(U,{open:t,onOpenChange:s})]})}},7739:(e,t,s)=>{"use strict";s.d(t,{ChatSidebar:()=>m});var a=s(7034),r=s(3587),n=s(1506),i=s(5584),o=s(7423),l=s(6030),d=s(6368),c=s(4396);let u=new(s(1633)).X;function m(){let{isSidebarOpen:e,setIsSidebarOpen:t}=(0,d.c)(),[s,m]=(0,r.useState)([]),h=(0,c.usePathname)(),x=(0,c.useRouter)(),f=(0,r.useCallback)(async()=>{m(await u.listConversations())},[]),v=async(e,t)=>{t.preventDefault();try{await u.deleteConversation(e),h===`/c/${e}`&&x.replace("/"),await f()}catch(e){console.error("Failed to delete conversation:",e)}};return(0,a.jsx)("div",{className:`fixed inset-y-0 left-0 z-50 w-64 bg-background border-r transform transition-transform duration-200 ease-in-out ${e?"translate-x-0":"-translate-x-full"}`,children:(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsx)("div",{className:"p-4",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>t(!1),className:"p-2 rounded-full bg-secondary hover:bg-secondary/80",children:(0,a.jsx)(i.A,{className:"h-3 w-3"})}),(0,a.jsx)(n.default,{href:"/",className:"p-2 rounded-full hover:rounded-full hover:bg-secondary/80",children:(0,a.jsx)(o.A,{className:"h-3 w-3"})})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,a.jsx)("div",{className:"p-4 space-y-2",children:s.map(e=>(0,a.jsxs)(n.default,{href:`/c/${e.id}`,className:"group block p-2 rounded-lg hover:bg-secondary/80 transition-colors relative",children:[(0,a.jsxs)("div",{className:"text-sm",children:[e.title,(0,a.jsx)("div",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleDateString()})]}),(0,a.jsx)("button",{type:"button",onClick:t=>v(e.id,t),className:"absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 p-1 hover:bg-destructive/10 rounded transition-opacity",children:(0,a.jsx)(l.A,{className:"h-4 w-4 text-destructive"})})]},e.id))})})]})})}},8475:(e,t,s)=>{"use strict";s.d(t,{ThemeProvider:()=>n});var a=s(7034);s(3587);var r=s(1200);function n({children:e,...t}){return(0,a.jsx)(r.N,{...t,children:e})}},6368:(e,t,s)=>{"use strict";s.d(t,{SidebarProvider:()=>i,c:()=>o});var a=s(7034),r=s(3587);let n=(0,r.createContext)(void 0);function i({children:e}){let[t,s]=(0,r.useState)(!0);return(0,a.jsx)(n.Provider,{value:{isSidebarOpen:t,toggleSidebar:()=>{s(!t)},setIsSidebarOpen:s},children:e})}function o(){let e=(0,r.useContext)(n);if(void 0===e)throw Error("useSidebar must be used within a SidebarProvider");return e}},1633:(e,t,s)=>{"use strict";s.d(t,{X:()=>i});var a=s(4132),r=s(3506);async function n(){return(0,a.P2)("fullmoon-db",1,{upgrade(e){e.createObjectStore("conversations",{keyPath:"id"}).createIndex("by-updated","updatedAt"),e.createObjectStore("messages",{keyPath:"id"}).createIndex("by-conversation","conversationId")}})}class i{async createConversation(e){let t=await n(),s={...e,id:(0,r.A)()};return await t.add("conversations",s),s}async getConversation(e){let t=await n();return await t.get("conversations",e)||null}async listConversations(){let e=await n();return await e.getAllFromIndex("conversations","by-updated")||[]}async updateConversation(e,t){let s=await n(),a=await this.getConversation(e);if(!a)throw Error(`Conversation not found: ${e}`);let r={...a,...t,updatedAt:new Date};return await s.put("conversations",r),r}async deleteConversation(e){let t=await n();await t.delete("conversations",e);let s=await this.getMessages(e);await Promise.all(s.map(e=>this.deleteMessage(e.id)))}async createMessage(e){let t=await n(),s={...e,id:(0,r.A)()};return await t.add("messages",s),s}async getMessages(e){return(await n()).getAllFromIndex("messages","by-conversation",e)}async deleteMessage(e){let t=await n();await t.delete("messages",e)}}},2978:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d,metadata:()=>l});var a=s(1358);s(5407);var r=s(4807),n=s.n(r);s(3051);var i=s(63),o=s(7620);let l={title:"Fullmoon Chat",description:"A chat interface powered by local LLMs"};function d({children:e}){return(0,a.jsx)("html",{lang:"en",suppressHydrationWarning:!0,children:(0,a.jsx)("body",{className:n().className,children:(0,a.jsx)(i.ThemeProvider,{attribute:"class",defaultTheme:"system",enableSystem:!0,disableTransitionOnChange:!0,children:(0,a.jsx)(o.SidebarProvider,{children:e})})})})}},63:(e,t,s)=>{"use strict";s.d(t,{ThemeProvider:()=>a});let a=(0,s(4174).registerClientReference)(function(){throw Error("Attempted to call ThemeProvider() from the server but ThemeProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/shiv/dev/mainframe/experiments/fullmoon-web/apps/web/src/components/ui/theme-provider.tsx","ThemeProvider")},7620:(e,t,s)=>{"use strict";s.d(t,{SidebarProvider:()=>r});var a=s(4174);let r=(0,a.registerClientReference)(function(){throw Error("Attempted to call SidebarProvider() from the server but SidebarProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/shiv/dev/mainframe/experiments/fullmoon-web/apps/web/src/contexts/SidebarContext.tsx","SidebarProvider");(0,a.registerClientReference)(function(){throw Error("Attempted to call useSidebar() from the server but useSidebar is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/shiv/dev/mainframe/experiments/fullmoon-web/apps/web/src/contexts/SidebarContext.tsx","useSidebar")},3051:()=>{}};